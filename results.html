<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="IoTGuard ‚Äî IoT anomaly detection results and live sensor details." />
  <title>IoT Anomaly Detection - Results | IoTGuard</title>
  <link rel="preconnect" href="https://picsum.photos" crossorigin />
  <style>
    :root{
      --primary-color:#007BFF;
      --secondary-color:#28a745;
      --accent-warn:#ffc107;
      --danger:#dc3545;
      --dark:#343a40;
      --light:#f8f9fa;
      --font-family: "Arial", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", sans-serif;
      --max-width:1200px;
      --gap:1.25rem;
      --radius:8px;
      --shadow: 0 6px 18px rgba(0,0,0,0.08);
      --container-pad:1.5rem;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:var(--font-family); line-height:1.45;
      background:var(--light); color:var(--dark);
    }
    .site-container{max-width:var(--max-width); margin:0 auto; padding:0 var(--container-pad)}
    header.site-header{background:var(--dark); color:var(--light)}
    .site-header .site-bar{display:flex;gap:var(--gap);align-items:center;justify-content:space-between;padding:.9rem 0}
    .brand a{color:var(--light);text-decoration:none;font-weight:700;font-size:1.25rem;display:inline-flex;gap:.5rem;align-items:center}
    nav.primary-nav a{color:var(--light);text-decoration:none;padding:.35rem .6rem;border-radius:6px}
    nav.primary-nav a:hover, nav.primary-nav a[aria-current="page"]{color:var(--primary-color)}
    .hero{position:relative;min-height:50vh;display:flex;align-items:center;justify-content:center;text-align:center;color:var(--light);overflow:hidden}
    .hero__bg{position:absolute;inset:0;background-image:url("https://picsum.photos/1200/600/?random=1");background-size:cover;background-position:center;filter:contrast(.95) brightness(.6);z-index:0}
    .hero::before{content:"";position:absolute;inset:0;background:linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.55));z-index:1}
    .hero-content{position:relative;z-index:2;padding:2rem 1rem;max-width:900px}
    .hero h1{font-size:2.25rem;margin:.25rem 0 .5rem}
    .btn{display:inline-block;text-decoration:none;padding:.6rem 1rem;border-radius:6px;font-weight:700}
    .btn--primary{background:var(--primary-color);color:#fff}
    .btn--secondary{background:var(--secondary-color);color:#fff}

    /* Results */
    section.results{padding:2.5rem 0}
    .results h2{font-size:1.75rem;margin:0;display:inline-block;border-bottom:3px solid var(--primary-color);padding-bottom:.35rem}
    .grid{display:flex;gap:1rem;margin-top:1.25rem;align-items:stretch}
    .grid-item{flex:1;background:#fff;padding:1.25rem;border-radius:var(--radius);box-shadow:var(--shadow);min-width:0}
    .grid-item h3{color:var(--primary-color);margin-bottom:.5rem;font-size:1.05rem}
    .metric{font-size:1.5rem;font-weight:800;margin-bottom:.5rem}
    .metric--success{color:var(--secondary-color)}
    .metric--warn{color:var(--accent-warn)}
    .metric--danger{color:var(--danger)}

    /* Sensor details area */
    .sensors{padding:1.5rem 0}
    .sensors-header{display:flex;align-items:center;justify-content:space-between;gap:1rem}
    .controls{display:flex;gap:.5rem;align-items:center}
    .sensor-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-top:1rem}
    .sensor-card{background:#fff;padding:1rem;border-radius:10px;box-shadow:var(--shadow);display:flex;flex-direction:column;gap:.5rem;min-height:160px}
    .sensor-head{display:flex;justify-content:space-between;align-items:center;gap:.5rem}
    .sensor-name{font-weight:700;color:var(--dark)}
    .status{font-weight:700;padding:.2rem .5rem;border-radius:6px;font-size:.85rem}
    .status.ok{background:#e8f8ef;color:var(--secondary-color);border:1px solid rgba(40,167,69,0.12)}
    .status.warn{background:#fff8e6;color:var(--accent-warn);border:1px solid rgba(255,193,7,0.12)}
    .status.critical{background:#fff0f0;color:var(--danger);border:1px solid rgba(220,53,69,0.08)}
    .value{font-size:1.6rem;font-weight:800}
    .meta{display:flex;gap:1rem;font-size:.9rem;color:#666;flex-wrap:wrap}
    .sparkline{width:100%;height:42px}
    .small{font-size:.85rem;color:#666}
    .raw-json{white-space:pre-wrap;background:#f6f8fa;padding:1rem;border-radius:6px;margin-top:.75rem;display:none;max-height:260px;overflow:auto;border:1px solid #e9eef5}

    @media (max-width:1000px){
      .sensor-grid{grid-template-columns:repeat(2,1fr)}
      .grid{flex-direction:column}
    }
    @media (max-width:640px){
      .sensor-grid{grid-template-columns:1fr}
      .hero h1{font-size:1.75rem}
    }
  </style>
</head>
<body>
  <header class="site-header" role="banner">
    <div class="site-container site-bar">
      <div class="brand">
        <a href="index.html" aria-label="IoTGuard home">IoTGuard <span aria-hidden="true">ü§ñ</span></a>
      </div>

      <nav class="primary-nav" role="navigation" aria-label="Main navigation">
        <a href="index.html">Home</a>
        <a href="methods.html">Methods</a>
        <a href="results.html" aria-current="page">Results</a>
        <a href="contact.html">Contact</a>
      </nav>
    </div>
  </header>

  <section class="hero" aria-labelledby="hero-heading">
    <div class="hero__bg" role="img" aria-label="Data and IoT background image"></div>
    <div class="site-container hero-content">
      <h1 id="hero-heading">IoT Anomaly Detection ‚Äî Results</h1>
      <p>High-accuracy anomaly detection for industrial IoT ‚Äî lower false alarms and actionable predictive maintenance insights.</p>
      <div>
        <a class="btn btn--secondary" href="contact.html">View Dashboard Demo & Contact</a>
      </div>
    </div>
  </section>

  <main id="main" class="site-container">
    <section class="results" aria-labelledby="results-heading">
      <h2 id="results-heading">üìà Key Results</h2>
      <div class="grid" role="list">
        <article class="grid-item" role="listitem" aria-labelledby="acc-title">
          <h3 id="acc-title">Detection Accuracy</h3>
          <p class="metric metric--success" aria-hidden="true">94%+</p>
          <p>Rate of correctly identifying anomalies across monitored systems.</p>
        </article>

        <article class="grid-item" role="listitem" aria-labelledby="fp-title">
          <h3 id="fp-title">False Positive Rate</h3>
          <p class="metric metric--danger" aria-hidden="true">Reduced by 5%</p>
          <p>Measured reduction in spurious alarms compared to baseline.</p>
        </article>

        <article class="grid-item" role="listitem" aria-labelledby="app-title">
          <h3 id="app-title">Application</h3>
          <p class="metric metric--warn" aria-hidden="true">Predictive Maintenance</p>
          <p>Provides early warnings to schedule maintenance before failure occurs.</p>
        </article>
      </div>
    </section>

    <!-- Sensor Details Section -->
    <section class="sensors" aria-labelledby="sensors-heading">
      <div class="sensors-header">
        <h2 id="sensors-heading">üîç Sensor Details (Live)</h2>
        <div class="controls">
          <label class="small" for="live-toggle">Live updates</label>
          <input type="checkbox" id="live-toggle" checked />
          <button id="btn-simulate" class="btn btn--primary" title="Pause/resume simulation">Pause</button>
          <button id="btn-show-json" class="btn" style="background:#eef2ff;border-radius:6px">Show Raw JSON</button>
        </div>
      </div>

      <div id="sensor-grid" class="sensor-grid" aria-live="polite" aria-atomic="false">
        <!-- Cards are injected by JS -->
      </div>

      <div id="raw-json" class="raw-json" aria-hidden="true"></div>
    </section>
  </main>

  <footer class="site-footer" role="contentinfo" style="background:var(--dark);color:var(--light);margin-top:2rem;padding:1.25rem 0">
    <div class="site-container site-bar" style="justify-content:center">
      <p>&copy; <span id="copy-year">2024</span> IoT Anomaly Detection Project ‚Ä¢ IoTGuard</p>
    </div>
  </footer>

  <script>
    // progressive copyright year
    try{ document.getElementById('copy-year').textContent = new Date().getFullYear(); }catch(e){}

    /***************
     * SENSOR UI + SIMULATOR
     * - Replace simulateSensorReadings() with your real data source (fetch / WebSocket)
     * - Each sensor keeps a buffer of recent values used to draw sparkline
     ***************/

    const SENSOR_DEFS = [
      { id: 'temp', name: 'Temperature', unit: '¬∞C', min: -10, max: 120, warnThreshold: 75, criticalThreshold: 95 },
      { id: 'hum', name: 'Humidity', unit: '%', min: 0, max: 100, warnThreshold: 80, criticalThreshold: 95 },
      { id: 'vib', name: 'Vibration', unit: 'g', min: 0, max: 50, warnThreshold: 8, criticalThreshold: 15 },
      { id: 'light', name: 'Light', unit: 'lux', min: 0, max: 100000, warnThreshold: 30000, criticalThreshold: 80000 },
      { id: 'gas', name: 'Gas (PPM)', unit: 'ppm', min: 0, max: 1000, warnThreshold: 200, criticalThreshold: 400 }
    ];

    // Store state for each sensor
    const sensorsState = {};
    const MAX_HISTORY = 20;

    // DOM refs
    const gridEl = document.getElementById('sensor-grid');
    const rawJsonEl = document.getElementById('raw-json');
    const btnShowJson = document.getElementById('btn-show-json');
    const liveToggle = document.getElementById('live-toggle');
    const btnSimulate = document.getElementById('btn-simulate');

    // Initialize state & UI
    function initSensors(){
      SENSOR_DEFS.forEach(def=>{
        sensorsState[def.id] = {
          def,
          history: [],
          last: null,
          min: null,
          max: null,
          element: createSensorCard(def)
        };
        gridEl.appendChild(sensorsState[def.id].element.card);
      });
    }

    // Create DOM card for sensor
    function createSensorCard(def){
      const card = document.createElement('div');
      card.className = 'sensor-card';
      card.setAttribute('role','article');
      card.setAttribute('aria-labelledby', def.id + '-name');

      // header
      const head = document.createElement('div'); head.className = 'sensor-head';
      const name = document.createElement('div'); name.className = 'sensor-name'; name.id = def.id + '-name';
      name.textContent = def.name;
      const status = document.createElement('div'); status.className = 'status ok'; status.id = def.id + '-status'; status.textContent = 'OK';
      head.appendChild(name); head.appendChild(status);

      // value
      const value = document.createElement('div'); value.className = 'value'; value.id = def.id + '-value'; value.textContent = '-- ' + def.unit;

      // meta
      const meta = document.createElement('div'); meta.className = 'meta';
      const last = document.createElement('div'); last.className='small'; last.id = def.id + '-last'; last.textContent = 'Last: --';
      const min = document.createElement('div'); min.className='small'; min.id = def.id + '-min'; min.textContent = 'Min: --';
      const max = document.createElement('div'); max.className='small'; max.id = def.id + '-max'; max.textContent = 'Max: --';
      meta.appendChild(last); meta.appendChild(min); meta.appendChild(max);

      // sparkline (svg)
      const svg = createSparklineSVG(def.id + '-spark', 200, 42);
      svg.classList.add('sparkline');

      // assemble
      card.appendChild(head);
      card.appendChild(value);
      card.appendChild(meta);
      card.appendChild(svg);

      return { card, valueEl: value, statusEl: status, lastEl: last, minEl: min, maxEl: max, sparkSvg: svg };
    }

    // Create empty sparkline SVG element
    function createSparklineSVG(id, width=200, height=42){
      const svgNS = "http://www.w3.org/2000/svg";
      const svg = document.createElementNS(svgNS, 'svg');
      svg.setAttribute('viewBox', `0 0 ${width} ${height}`);
      svg.setAttribute('preserveAspectRatio', 'none');
      svg.setAttribute('width', '100%');
      svg.setAttribute('height', height);
      svg.setAttribute('id', id);
      // polyline for the line
      const poly = document.createElementNS(svgNS, 'polyline');
      poly.setAttribute('fill','none');
      poly.setAttribute('stroke','#007bff');
      poly.setAttribute('stroke-width','2');
      poly.setAttribute('points','');
      poly.setAttribute('class','spark-poly');
      svg.appendChild(poly);
      return svg;
    }

    // Update sparkline with numeric history array
    function updateSparkline(svgEl, history, def){
      const width = svgEl.viewBox.baseVal.width;
      const height = svgEl.viewBox.baseVal.height;
      const poly = svgEl.querySelector('.spark-poly');
      if(!poly) return;
      const n = Math.max(1, history.length);
      const pts = history.map((v,i)=>{
        // normalize between def.min..def.max
        const min = def.min;
        const max = def.max;
        const clamped = Math.max(min, Math.min(max, v));
        const x = (i / (n-1 || 1)) * width;
        const y = height - ((clamped - min) / (max - min || 1)) * height;
        return `${x},${y}`;
      }).join(' ');
      poly.setAttribute('points', pts);
    }

    // Determine status class (ok/warn/critical)
    function computeStatus(def, value){
      if(value >= def.criticalThreshold) return 'critical';
      if(value >= def.warnThreshold) return 'warn';
      return 'ok';
    }

    // Format timestamp
    function formatTS(ts){ const d=new Date(ts); return d.toLocaleTimeString(); }

    // Simulate sensor readings (replace this with real data calls)
    function simulateSensorReadings(){
      const now = Date.now();
      const payload = {}; // for raw JSON display
      SENSOR_DEFS.forEach(def=>{
        // create a pseudo-random smoothed value per sensor:
        const state = sensorsState[def.id];
        let base;
        // pick sensible baseline per sensor type
        if(def.id === 'temp') base = 45 + Math.sin(now/60000)*10; // fluctuates
        else if(def.id === 'hum') base = 50 + Math.sin(now/45000)*20;
        else if(def.id === 'vib') base = Math.abs(Math.sin(now/5000))*6;
        else if(def.id === 'light') base = 20000 + Math.abs(Math.sin(now/70000))*30000;
        else if(def.id === 'gas') base = 100 + Math.abs(Math.sin(now/30000))*80;
        // add random jitter
        const jitter = (Math.random()-0.5) * ( (def.max - def.min) * 0.02 );
        const value = Math.round((base + jitter) * 100) / 100;
        payload[def.id] = { ts: now, value };
      });
      return payload;
    }

    // Apply new readings to UI & state
    function applyReadings(payload){
      Object.keys(payload).forEach(id=>{
        const reading = payload[id];
        const s = sensorsState[id];
        if(!s) return;
        const val = Number(reading.value);
        s.last = reading.ts;
        s.history.push(val);
        if(s.history.length > MAX_HISTORY) s.history.shift();
        s.min = (s.min === null) ? val : Math.min(s.min, val);
        s.max = (s.max === null) ? val : Math.max(s.max, val);

        // update DOM
        s.element.valueEl.textContent = `${val} ${s.def.unit}`;
        const statusClass = computeStatus(s.def, val);
        s.element.statusEl.className = 'status ' + statusClass;
        s.element.statusEl.textContent = statusClass === 'ok' ? 'OK' : (statusClass === 'warn' ? 'Warning' : 'Critical');
        s.element.lastEl.textContent = 'Last: ' + formatTS(s.last);
        s.element.minEl.textContent = 'Min: ' + s.min + ' ' + s.def.unit;
        s.element.maxEl.textContent = 'Max: ' + s.max + ' ' + s.def.unit;

        updateSparkline(s.element.sparkSvg, s.history, s.def);
      });

      // update raw JSON display if visible
      if(rawJsonEl.style.display !== 'none') {
        rawJsonEl.textContent = JSON.stringify(payload, null, 2);
      }
    }

    // Live update loop
    let intervalId = null;
    let running = true;
    function startLoop(){
      if(intervalId) clearInterval(intervalId);
      intervalId = setInterval(()=>{
        if(!running || !liveToggle.checked) return;
        const payload = simulateSensorReadings();
        applyReadings(payload);
      }, 2000);
    }

    // UI handlers
    btnShowJson.addEventListener('click', ()=>{
      const visible = rawJsonEl.style.display !== 'none';
      rawJsonEl.style.display = visible ? 'none' : 'block';
      rawJsonEl.setAttribute('aria-hidden', visible ? 'true' : 'false');
      btnShowJson.textContent = visible ? 'Show Raw JSON' : 'Hide Raw JSON';
      // populate once
      if(!visible){
        // show latest snapshot
        const snapshot = {};
        Object.keys(sensorsState).forEach(id=>{
          const s = sensorsState[id];
          snapshot[id] = { last: s.last, value: s.history[s.history.length-1] ?? null, min: s.min, max: s.max };
        });
        rawJsonEl.textContent = JSON.stringify(snapshot, null, 2);
      }
    });

    // Pause / resume simulation button
    btnSimulate.addEventListener('click', ()=>{
      running = !running;
      btnSimulate.textContent = running ? 'Pause' : 'Resume';
      btnSimulate.style.background = running ? 'var(--primary-color)' : '#ddd';
    });

    // live toggle label click is native; just ensure ARIA
    liveToggle.addEventListener('change', ()=>{
      // if turned off, we still keep simulation paused visually
      if(!liveToggle.checked){
        // mark visually (optional)
      }
    });

    // initialize everything and start
    initSensors();
    // perform a first immediate reading
    applyReadings(simulateSensorReadings());
    startLoop();

    // Expose a function to integrate real data:
    // Example: when you receive data from server: call `applyReadings(receivedPayload)`
    // where receivedPayload is { temp: {ts:..., value:...}, hum: {...}, ... }
    window.applySensorPayload = applyReadings;
  </script>
</body>
</html>
